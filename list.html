<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Daftar Hasil Sensus Pokok</title>
  <style>
    body { font-family: Arial; padding: 20px; }
    table { width: 100%; border-collapse: collapse; margin-top: 20px; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
    th { background-color: #f2f2f2; }
    td.blok-cell { color: blue; text-decoration: underline; cursor: pointer; }
    .btn-view { background-color: #4CAF50; color: white; border: none; padding: 6px 12px; cursor: pointer; border-radius: 4px; }
  </style>
</head>
<body>

<h2>Daftar Hasil Sensus Pokok</h2>
<table id="sensusTable">
  <thead>
    <tr>
      <th>Tanggal</th>
      <th>Kebun</th>
      <th>Divisi</th>
      <th>Blok</th>
      <th>Data</th>
      <th>Nama File</th>
      <th>Link</th>
      <th>Folder Path</th>
      <th>Aksi</th>
    </tr>
  </thead>
  <tbody>
    <!-- Data akan diisi lewat JavaScript -->
  </tbody>
</table>

<script>
  const SHEET_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vTYyCf6JfGComZrmquPZ487oZPME6IE1YOdQ530KQN2OQsP_aWxTx8CYvKjGjHB7riZnIh3pArGw8t2/pub?output=csv";

  fetch(SHEET_URL)
    .then(res => res.text())
    .then(csv => {
      const rows = csv.split("\n").slice(1);
      const tableBody = document.querySelector("#sensusTable tbody");
      const allData = [];

      rows.forEach(row => {
        const cols = row.split(",");
        if (cols.length < 8) return;

        const tr = document.createElement("tr");

        cols.forEach((col, i) => {
          const td = document.createElement("td");
          td.innerHTML = i === 6 ? `<a href="${col}" target="_blank">Link</a>` : col;
          if (i === 3) td.classList.add("blok-cell");
          tr.appendChild(td);
        });

        // Tombol aksi
        const aksiTd = document.createElement("td");
        const viewBtn = document.createElement("button");
        viewBtn.className = "btn-view";
        viewBtn.textContent = "Lihat Peta";
        viewBtn.onclick = () => {
          const kebun = cols[1];
          const divisi = cols[2];
          const blok = cols[3];
          window.open(`viewpeta.html?kebun=${encodeURIComponent(kebun)}&divisi=${encodeURIComponent(divisi)}&blok=${encodeURIComponent(blok)}`, "_blank");
        };
        aksiTd.appendChild(viewBtn);
        tr.appendChild(aksiTd);

        allData.push({ kebun: cols[1], divisi: cols[2], blok: cols[3], all: cols });
        tableBody.appendChild(tr);
      });
    });
</script>

</body>
</html>

